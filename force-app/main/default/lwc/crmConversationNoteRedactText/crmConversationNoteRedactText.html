<template>
    <lightning-card title="Samtale" icon-name="custom:custom22">
        <div lwc:if={isRedacted} class="slds-p-horizontal_small">
            <lightning-formatted-rich-text value={text}></lightning-formatted-rich-text>
            <br /><br />
            <p>{redactionInfo}</p>
        </div>
        <div lwc:else class="slds-p-horizontal_small">
            <lightning-layout multiple-rows="true">
                <lightning-layout-item size="12" class="slds-is-relative">
                    <lightning-record-edit-form
                        lwc:if={isRedacting}
                        object-api-name="Conversation_Note__c"
                        record-id={recordId}
                        onsubmit={handleSubmit}
                    >
                        <lightning-spinner
                            lwc:if={showSpinner}
                            alternative-text="Lagrer"
                            size="small"
                        ></lightning-spinner>
                        <c-crm-redact-text text-to-redact={text} ontext_redacted={handleRedactEvent}>
                            <lightning-button
                                slot="toolbarEnd"
                                label="Lagre"
                                icon-name="utility:save"
                                disabled={canSaveDisabled}
                                variant="brand"
                                type="submit"
                                class="slds-p-left_large"
                            ></lightning-button>
                        </c-crm-redact-text>
                    </lightning-record-edit-form>
                    <lightning-formatted-rich-text lwc:else value={text}></lightning-formatted-rich-text>
                </lightning-layout-item>
                <lightning-layout-item>
                    <lightning-button-stateful
                        icon-name-when-off="utility:edit"
                        icon-name-when-on="utility:edit"
                        selected={isRedacting}
                        onclick={toggleRedacting}
                        label-when-off="Start sladding"
                        label-when-on="Avbryt sladding"
                    ></lightning-button-stateful>
                </lightning-layout-item>
            </lightning-layout>
        </div>
    </lightning-card>
</template>
